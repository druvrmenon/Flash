<!DOCTYPE html>
<html lang="en" data-theme="aurora">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>FlashGen â€” AI Exam Flashcard Generator</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FlashGen">
<meta name="theme-color" content="#07091a">
<link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,700&family=Sora:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body>

<!-- OFFLINE BANNER -->
<div class="offline-banner" id="offline-banner">âš  You're offline â€” saved decks still work, but generation requires internet</div>

<!-- â•â• API KEY SCREEN â•â• -->
<div id="screen-apikey" class="screen active">
  <div class="api-card">
    <div class="logo">FlashGen</div>
    <h2>Welcome back, scholar</h2>
    <p>Enter your free Gemini 2.5 API key to unlock AI-powered flashcards from any PDF or YouTube lecture.</p>
    <div><span class="lbl">Gemini API Key</span><input class="inp" type="password" id="api-key-input" placeholder="AIzaâ€¦" autocomplete="off" spellcheck="false"/></div>
    <button class="btn-full" id="api-save-btn">Save Key &amp; Start Learning â†’</button>
    <div class="api-note">ğŸ”‘ Get a free key at <a href="https://aistudio.google.com/apikey" target="_blank"><strong>aistudio.google.com/apikey</strong></a> â†’ Create API key â†’ Create API key in new project.<br><br>âš  <strong>Use AI Studio only</strong> â€” not Google Cloud Console. Cloud Console keys have no free tier.<br><br>ğŸ”’ Stored in your browser only. Sent directly to Google.</div>
  </div>
</div>

<!-- â•â• UPLOAD SCREEN â•â• -->
<div id="screen-upload" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen <span style="font-size:.55rem;font-family:'JetBrains Mono',monospace;opacity:.5;font-weight:400;-webkit-text-fill-color:var(--ink-2);background:none">gemma-3-27b</span></div>
    <div class="nav-streak" id="nav-streak">ğŸ”¥<span id="nav-snum">0</span></div>
    <div class="nav-actions">
      <div class="swatches" id="sw-row">
        <div class="sw active" data-t="aurora" style="background:linear-gradient(135deg,#7c6ffa,#22d3ee)" title="Aurora"></div>
        <div class="sw" data-t="parchment" style="background:#b45309" title="Parchment"></div>
        <div class="sw" data-t="sakura" style="background:#db2777" title="Sakura"></div>
        <div class="sw" data-t="ocean" style="background:#0369a1" title="Ocean"></div>
        <div class="sw" data-t="forest" style="background:#166534" title="Forest"></div>
        <div class="sw" data-t="ember" style="background:linear-gradient(135deg,#c2410c,#f59e0b)" title="Ember"></div>
        <div class="sw" data-t="neon" style="background:linear-gradient(135deg,#a855f7,#ec4899)" title="Neon"></div>
        <div class="sw" data-t="slate" style="background:linear-gradient(135deg,#4f46e5,#7c3aed)" title="Slate"></div>
      </div>
      <div class="offline-dot" id="offline-dot"></div>
      <button class="nb" id="btn-dash">ğŸ“Š Dashboard</button>
      <button class="nb" id="btn-lib">ğŸ“š Library</button>
      <button class="nb" id="btn-key">ğŸ”‘ Key</button>
    </div>
  </nav>

  <div class="upload-grid">
    <div class="hero fin">
      <h1>Study smarter.<br><span>Ace your exams.</span></h1>
      <p>FlashGen turns any PDF or YouTube lecture into exam-ready flashcards â€” with spaced repetition, quiz mode, voice, and full progress tracking.</p>
      <div class="feat-chips">
        <span class="fc">ğŸ§  SM-2 Spaced Repetition</span>
        <span class="fc">ğŸ¯ Mock Quiz Mode</span>
        <span class="fc">ğŸ”Š Voice Mode</span>
        <span class="fc">ğŸ“Š Progress Dashboard</span>
        <span class="fc">ğŸ¯ Weak Spot Detector</span>
        <span class="fc">ğŸ“– NCERT Chapters</span>
        <span class="fc">â–¶ï¸ YouTube â†’ Cards</span>
        <span class="fc">ğŸ”€ Deck Merge</span>
        <span class="fc">ğŸ’¡ AI Explain</span>
        <span class="fc">ğŸ¨ 8 Themes</span>
      </div>
    </div>

    <div class="panel fin" style="animation-delay:.1s">
      <div class="tabs">
        <button class="tab active" data-tab="pdf">ğŸ“„ PDF Upload</button>
        <button class="tab" data-tab="yt">â–¶ï¸ YouTube</button>
      </div>

      <div class="tabp active" id="tab-pdf">
        <div class="dz" id="dz">
          <input type="file" id="pdf-input" accept=".pdf"/>
          <div class="dz-icon">ğŸ“„</div>
          <div class="dz-title">Tap to choose a PDF</div>
          <div class="dz-sub">NCERT chapters, notes, past papers Â· max 20 MB</div>
          <div class="fpill" id="fpill"><span>âœ…</span><span id="fname">â€”</span></div>
        </div>
      </div>

      <div class="tabp" id="tab-yt">
        <span class="lbl">YouTube Video URL</span>
        <input class="yt-inp" type="url" id="yt-inp" placeholder="https://www.youtube.com/watch?v=â€¦"/>
        <div class="yt-note">âš¡ Gemini 2.5 reads the video directly â€” no transcript needed. Works with any educational YouTube video.</div>
      </div>

      <div><span class="lbl">Exam Type</span>
        <select class="sel" id="exam-sel">
          <option value="CBSE-10">CBSE Class 10</option>
          <option value="CBSE-12" selected>CBSE Class 12</option>
          <option value="JEE-Main">JEE Main</option>
          <option value="JEE-Advanced">JEE Advanced</option>
          <option value="NEET">NEET</option>
          <option value="UPSC">UPSC</option>
          <option value="General">General / Other</option>
        </select>
      </div>

      <div><span class="lbl">Number of Flashcards</span>
        <div class="cnt-row" id="cnt-row">
          <button class="cc" data-n="5">5</button>
          <button class="cc active" data-n="10">10</button>
          <button class="cc" data-n="15">15</button>
          <button class="cc" data-n="20">20</button>
          <button class="cc" data-n="30">30</button>
        </div>
        <div class="cust-row"><label>Custom:</label><input type="number" id="cust-n" min="3" max="50" placeholder="3â€“50"/></div>
      </div>

      <div><span class="lbl">Exam Date (sets priority &amp; countdown)</span>
        <div class="date-row"><input type="date" id="exam-date"/><button id="date-save">Set Date</button></div>
        <div id="cd-msg"></div>
      </div>

      <button class="btn-full" id="gen-btn" disabled>âœ¨ Generate Flashcards</button>
    </div>
  </div>

  <!-- Library -->
  <div class="lib-sec" id="lib-sec">
    <div class="lib-hdr">
      <div class="lib-ttl">ğŸ“š My Library</div>
      <div class="merge-controls">
        <button class="nb" id="merge-toggle-btn">ğŸ”€ Merge Decks</button>
        <button class="nb primary" id="merge-do-btn" style="display:none">Merge Selected â†’</button>
        <button class="nb" id="merge-cancel-btn" style="display:none">Cancel</button>
      </div>
    </div>
    <div id="lib-container"><div class="lib-empty">No saved decks yet. Generate your first deck above!</div></div>
  </div>
</div>

<!-- â•â• LOADING SCREEN â•â• -->
<div id="screen-loading" class="screen">
  <div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.6rem;padding:2rem">
    <div class="spinner"></div>
    <div class="ld-h">Generating flashcardsâ€¦</div>
    <div class="ld-s">Powered by Gemma 3 27B Â· 30 requests/min free âœ“</div>
    <div class="ld-steps">
      <div class="ldstep" id="ls0"><div class="ldstep-dot"></div>Reading source contentâ€¦</div>
      <div class="ldstep" id="ls1"><div class="ldstep-dot"></div>Extracting formulas, diagrams &amp; conceptsâ€¦</div>
      <div class="ldstep" id="ls2"><div class="ldstep-dot"></div>Building exam-level Q&amp;A pairsâ€¦</div>
      <div class="ldstep" id="ls3"><div class="ldstep-dot"></div>Mapping to NCERT chapters &amp; prioritiesâ€¦</div>
    </div>
  </div>
</div>

<!-- â•â• CARD VIEWER â•â• -->
<div id="screen-cards" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen</div>
    <div class="nav-actions">
      <button class="nb sb-toggle" id="sb-toggle">ğŸ· Topics</button>
      <button class="nb" id="cv-back">â† Library</button>
      <button class="nb" id="cv-quiz">ğŸ¯ Quiz Mode</button>
      <button class="nb" id="cv-dash">ğŸ“Š Stats</button>
      <button class="nb primary" id="cv-new">+ New</button>
    </div>
  </nav>
  <div class="exam-banner" id="exam-banner"></div>
  <div class="cv-layout">
    <div class="sidebar" id="sidebar">
      <div class="sbhd">Document</div>
      <div class="sb-info" id="sb-name">â€”</div>
      <div class="sb-meta-t" id="sb-meta">â€”</div>
      <div id="sb-chapters"></div>
      <div id="sb-topics"></div>
    </div>
    <div class="card-area">
      <div class="doc-banner fin">
        <div class="di">ğŸ“‘</div>
        <div style="flex:1"><div class="dn" id="doc-name">â€”</div><div class="dm" id="doc-meta">â€”</div></div>
        <div class="etag" id="etag" style="display:none"></div>
      </div>
      <div class="prog-wrap fin" style="animation-delay:.05s">
        <div class="prog-info"><span id="card-ctr">1 / 10</span><span id="pct-seen">0% seen</span></div>
        <div class="prog-track"><div class="prog-fill" id="prog-fill" style="width:0%"></div></div>
      </div>
      <div class="card-scene" id="card-scene">
        <div class="card-inner">
          <div class="card-face card-front">
            <div class="priodot" id="prio-dot"></div>
            <div class="tbadge" id="tbadge-f"></div>
            <div class="cchip" id="chip-f">Topic</div>
            <div class="card-q" id="card-q">â€”</div>
            <div class="flip-hint">tap to reveal â†©</div>
          </div>
          <div class="card-face card-back">
            <div class="tbadge" id="tbadge-b"></div>
            <div class="cchip" id="chip-b">Answer</div>
            <div class="card-a" id="card-a">â€”</div>
            <div class="flip-hint">tap to flip back â†©</div>
          </div>
        </div>
      </div>
      <!-- SM-2 Rating (shows after flip) -->
      <div class="sr-row fin" id="sr-row" style="display:none;animation-delay:.08s">
        <button class="sr-btn sr-again" id="sr-again">â†© Again<br><small>forgot</small></button>
        <button class="sr-btn sr-hard" id="sr-hard">ğŸ˜“ Hard<br><small>+1 day</small></button>
        <button class="sr-btn sr-good" id="sr-good">ğŸ‘ Good<br><small>tomorrow</small></button>
        <button class="sr-btn sr-easy" id="sr-easy">âš¡ Easy<br><small>next week</small></button>
      </div>
      <div class="sr-hint" id="sr-hint" style="display:none">Rate to schedule with Spaced Repetition Â· <kbd>1</kbd> Again Â· <kbd>2</kbd> Hard Â· <kbd>3</kbd> Good Â· <kbd>4</kbd> Easy</div>
      <div class="card-ctrls fin" style="animation-delay:.12s">
        <button class="ctrl ctrl-nav" id="prev-btn" disabled>â† Prev</button>
        <button class="ctrl ctrl-flip" id="flip-btn">Flip Card</button>
        <button class="ctrl ctrl-nav" id="next-btn">Next â†’</button>
        <button class="ctrl ctrl-act" id="explain-btn">ğŸ’¡ Explain</button>
        <button class="ctrl ctrl-act" id="voice-btn">ğŸ”Š Read</button>
        <button class="ctrl ctrl-act" id="shuffle-btn">ğŸ”€</button>
      </div>
      <div class="swipe-indicator">ğŸ‘† Swipe card left/right to navigate</div>
      <div class="kb-row">
        <span><kbd>â†</kbd> prev</span><span><kbd>Space</kbd> flip</span><span><kbd>â†’</kbd> next</span>
        <span><kbd>1-4</kbd> rate</span><span><kbd>E</kbd> explain</span><span><kbd>V</kbd> voice</span>
      </div>
    </div>
  </div>
</div>

<!-- â•â• EXPLAIN MODAL â•â• -->
<div class="modal-overlay" id="explain-overlay">
  <div class="explain-modal">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ’¡ Deep Explanation</div>
      <button class="explain-close" id="explain-close">âœ• Close</button>
    </div>
    <div id="explain-body"></div>
  </div>
</div>

<!-- â•â• DASHBOARD â•â• -->
<div id="screen-dashboard" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen</div>
    <div class="nav-actions"><button class="nb" id="dash-back">â† Back</button></div>
  </nav>
  <div class="dash-wrap">
    <div class="dash-ttl">Your <span>Progress</span></div>
    <div class="dash-grid">
      <div class="dc">
        <h3>ğŸ“ˆ Overview</h3>
        <div class="stat-row">
          <div class="sbox"><div class="snum" id="s-decks">0</div><div class="slbl">Decks</div></div>
          <div class="sbox"><div class="snum" id="s-rated">0</div><div class="slbl">Rated</div></div>
          <div class="sbox"><div class="snum" id="s-pct">â€”</div><div class="slbl">Known %</div></div>
          <div class="sbox"><div class="snum" id="s-due">0</div><div class="slbl">Due Today</div></div>
        </div>
      </div>
      <div class="dc">
        <h3>ğŸ”¥ Study Streak</h3>
        <div class="streak-disp">
          <div class="sf">ğŸ”¥</div>
          <div><div class="sn" id="d-streak">0</div><div class="ss" id="d-sub">days in a row</div><div class="ss" style="margin-top:.2rem">Best: <strong id="d-best">0</strong> days</div></div>
        </div>
        <div class="scal" id="d-cal"></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ† Badges</h3>
        <div class="badges-g" id="badges-g"></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ¯ Weak Spots <small style="font-size:.7rem;color:var(--ink-2);font-weight:300;font-family:'JetBrains Mono',monospace"> â€” topics needing attention</small></h3>
        <div class="weak-list" id="weak-list"><div style="color:var(--ink-2);font-size:.85rem">Rate cards to identify weak spots!</div></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ“Š Topic Mastery</h3>
        <div id="no-mastery" style="color:var(--ink-2);font-size:.85rem;text-align:center;padding:2rem">Flip cards and rate them to see mastery here!</div>
        <div class="chart-wrap" id="chart-wrap" style="display:none"><canvas id="mastery-chart"></canvas></div>
        <table class="mtable" id="mtable" style="display:none">
          <thead><tr><th>Topic</th><th>Chapter</th><th>âœ“ Known</th><th>âœ— Review</th><th>Mastery</th><th>SR Due</th></tr></thead>
          <tbody id="mtbody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script src="app.js"></script>
</body>
</html>
