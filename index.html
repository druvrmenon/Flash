<!DOCTYPE html>
<html lang="en" data-theme="aurora">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>FlashGen â€” AI Exam Flashcard Generator</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FlashGen">
<meta name="theme-color" content="#07091a">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body>

<!-- OFFLINE BANNER -->
<div class="offline-banner" id="offline-banner">âš  You're offline â€” saved decks still work, but generation requires internet</div>

<!-- â•â• API KEY SCREEN â•â• -->
<div id="screen-apikey" class="screen active">
  <div class="api-card">
    <div class="logo">FlashGen</div>
    <h2>Welcome back, scholar</h2>
    <p>Enter your free Gemini 2.5 API key to unlock AI-powered flashcards from any PDF or YouTube lecture.</p>
    <div><span class="lbl">Gemini API Key</span><input class="inp" type="password" id="api-key-input" placeholder="AIzaâ€¦" autocomplete="off" spellcheck="false"/></div>
    <button class="btn-full" id="api-save-btn">Save Key &amp; Start Learning â†’</button>
    <div class="api-note">ğŸ”‘ Get a free key at <a href="https://aistudio.google.com/apikey" target="_blank"><strong>aistudio.google.com/apikey</strong></a> â†’ Create API key in new project.<br><br>âš  <strong>Use AI Studio only</strong> â€” not Google Cloud Console. Cloud Console keys have no free tier.<br><br>ğŸ”’ Stored in your browser only. Sent directly to Google.</div>
  </div>
</div>

<!-- â•â• UPLOAD SCREEN â•â• -->
<div id="screen-upload" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen <span style="font-size:.55rem;font-family:'DM Mono',monospace;opacity:.5;font-weight:400;-webkit-text-fill-color:var(--ink-2);background:none">gemma-3-27b</span></div>
    <div class="nav-streak" id="nav-streak">ğŸ”¥<span id="nav-snum">0</span></div>
    <div class="nav-actions">
      <div class="swatches" id="sw-row">
        <!-- Light themes -->
        <div class="sw" data-t="parchment" style="background:#b45309" title="Parchment"></div>
        <div class="sw" data-t="sakura" style="background:#db2777" title="Sakura"></div>
        <div class="sw" data-t="ocean" style="background:#0369a1" title="Ocean"></div>
        <div class="sw" data-t="forest" style="background:#166534" title="Forest"></div>
        <!-- Dark themes -->
        <div class="sw active" data-t="aurora" style="background:linear-gradient(135deg,#7c6ffa,#22d3ee)" title="Aurora (Dark)"></div>
        <div class="sw" data-t="neon" style="background:linear-gradient(135deg,#a855f7,#ec4899)" title="Neon (Dark)"></div>
        <div class="sw" data-t="midnight" style="background:linear-gradient(135deg,#1e3a5f,#0f2340)" title="Midnight (Dark)"></div>
        <div class="sw" data-t="cyberpunk" style="background:linear-gradient(135deg,#ff0080,#7700ff)" title="Cyberpunk (Dark)"></div>
        <div class="sw" data-t="dracula" style="background:linear-gradient(135deg,#bd93f9,#282a36)" title="Dracula (Dark)"></div>
        <div class="sw" data-t="obsidian" style="background:linear-gradient(135deg,#2d2d2d,#1a1a2e)" title="Obsidian (Dark)"></div>
        <div class="sw" data-t="deepspace" style="background:linear-gradient(135deg,#0a0a23,#4a0072)" title="Deep Space (Dark)"></div>
        <div class="sw" data-t="ember" style="background:linear-gradient(135deg,#c2410c,#f59e0b)" title="Ember"></div>
      </div>
      <div class="offline-dot" id="offline-dot"></div>
      <button class="nb" id="btn-timer">â± Timer</button>
      <button class="nb" id="btn-shop">ğŸ› Shop</button>
      <button class="nb" id="btn-rooms">ğŸ‘¥ Study Room</button>
      <button class="nb" id="btn-dash">ğŸ“Š Dashboard</button>
      <button class="nb" id="btn-lib">ğŸ“š Library</button>
      <button class="nb" id="btn-key">ğŸ”‘ Key</button>
    </div>
  </nav>

  <div class="upload-grid">
    <div class="hero fin">
      <h1>Study smarter.<br><span>Ace your exams.</span></h1>
      <p>FlashGen turns PDFs &amp; YouTube lectures into exam-ready flashcards â€” with spaced repetition, quiz mode, AI doubts, and full progress tracking.</p>
      <div class="feat-chips">
        <span class="fc">ğŸ§  SM-2 Spaced Repetition</span>
        <span class="fc">ğŸ¯ Mock Quiz Mode</span>
        <span class="fc">ğŸ”Š Voice Mode</span>
        <span class="fc">ğŸ“Š Progress Dashboard</span>
        <span class="fc">ğŸ¯ Weak Spot Detector</span>
        <span class="fc">ğŸ“ Weak Topic Notes</span>
        <span class="fc">ğŸ¤– AI Doubt Chat</span>
        <span class="fc">â± Focus Timer</span>
        <span class="fc">ğŸ“„ Multi-PDF Upload</span>
        <span class="fc">ğŸ¨ 11 Themes</span>
        <span class="fc">ğŸ· Smart Tags</span>
        <span class="fc">ğŸ“‹ AI Summary</span>
      </div>

      <!-- NEW FEATURE HIGHLIGHT -->
      <div class="new-features-banner">
        <div class="nf-title">âœ¨ New Features</div>
        <div class="nf-grid">
          <div class="nf-item">
            <span class="nf-icon">ğŸ“„</span>
            <div><strong>Multi-PDF Upload</strong><br>Upload multiple PDFs and merge them into one deck</div>
          </div>
          <div class="nf-item">
            <span class="nf-icon">ğŸ¤–</span>
            <div><strong>AI Doubt Chat</strong><br>Ask the AI doubts about any weak topic in real-time</div>
          </div>
          <div class="nf-item">
            <span class="nf-icon">ğŸ“</span>
            <div><strong>Weak Topic Notes</strong><br>Write your own notes on weak topics for better retention</div>
          </div>
          <div class="nf-item">
            <span class="nf-icon">â±</span>
            <div><strong>Focus Timer</strong><br>Pomodoro-style study timer with session tracking</div>
          </div>
          <div class="nf-item">
            <span class="nf-icon">ğŸ“‹</span>
            <div><strong>AI Summary</strong><br>Get an instant AI-generated topic summary from any card</div>
          </div>
        </div>
      </div>
    </div>

    <div class="panel fin" style="animation-delay:.1s">
      <div class="tabs">
        <button class="tab active" data-tab="pdf">ğŸ“„ PDF Upload</button>
        <button class="tab" data-tab="yt">â–¶ï¸ YouTube</button>
      </div>

      <div class="tabp active" id="tab-pdf">
        <!-- MULTI-FILE DROP ZONE -->
        <div class="dz" id="dz">
          <input type="file" id="pdf-input" accept=".pdf" multiple/>
          <div class="dz-icon">ğŸ“„</div>
          <div class="dz-title">Tap to choose PDFs</div>
          <div class="dz-sub">Drop multiple PDFs here Â· Each max 20 MB Â· They'll be combined into one deck</div>
        </div>
        <!-- File list -->
        <div id="file-list" class="file-list" style="display:none"></div>
      </div>

      <div class="tabp" id="tab-yt">
        <span class="lbl">YouTube Video URL</span>
        <input class="yt-inp" type="url" id="yt-inp" placeholder="https://www.youtube.com/watch?v=â€¦"/>
        <div class="yt-note">âš¡ Gemini 2.5 reads the video directly â€” no transcript needed. Works with any educational YouTube video.</div>
      </div>

      <div><span class="lbl">Exam Type</span>
        <select class="sel" id="exam-sel">
          <option value="CBSE-10">CBSE Class 10</option>
          <option value="CBSE-12" selected>CBSE Class 12</option>
          <option value="JEE-Main">JEE Main</option>
          <option value="JEE-Advanced">JEE Advanced</option>
          <option value="NEET">NEET</option>
          <option value="UPSC">UPSC</option>
          <option value="General">General / Other</option>
        </select>
      </div>

      <div><span class="lbl">Number of Flashcards</span>
        <div class="cnt-row" id="cnt-row">
          <button class="cc" data-n="5">5</button>
          <button class="cc active" data-n="10">10</button>
          <button class="cc" data-n="15">15</button>
          <button class="cc" data-n="20">20</button>
          <button class="cc" data-n="30">30</button>
        </div>
        <div class="cust-row"><label>Custom:</label><input type="number" id="cust-n" min="3" max="50" placeholder="3â€“50"/></div>
      </div>

      <div><span class="lbl">Exam Date (sets priority &amp; countdown)</span>
        <div class="date-row"><input type="date" id="exam-date"/><button id="date-save">Set Date</button></div>
        <div id="cd-msg"></div>
      </div>

      <button class="btn-full" id="gen-btn" disabled>âœ¨ Generate Flashcards</button>
    </div>
  </div>

  <!-- Library -->
  <div class="lib-sec" id="lib-sec">
    <div class="lib-hdr">
      <div class="lib-ttl">ğŸ“š My Library</div>
      <div class="merge-controls">
        <button class="nb" id="merge-toggle-btn">ğŸ”€ Merge Decks</button>
        <button class="nb primary" id="merge-do-btn" style="display:none">Merge Selected â†’</button>
        <button class="nb" id="merge-cancel-btn" style="display:none">Cancel</button>
      </div>
    </div>
    <div id="lib-container"><div class="lib-empty">No saved decks yet. Generate your first deck above!</div></div>
  </div>
</div>

<!-- â•â• LOADING SCREEN â•â• -->
<div id="screen-loading" class="screen">
  <div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.6rem;padding:2rem">
    <div class="spinner"></div>
    <div class="ld-h">Generating flashcardsâ€¦</div>
    <div class="ld-s" id="ld-sub">Powered by Gemma 3 27B Â· 30 requests/min free âœ“</div>
    <div class="ld-steps">
      <div class="ldstep" id="ls0"><div class="ldstep-dot"></div>Reading source contentâ€¦</div>
      <div class="ldstep" id="ls1"><div class="ldstep-dot"></div>Extracting formulas, diagrams &amp; conceptsâ€¦</div>
      <div class="ldstep" id="ls2"><div class="ldstep-dot"></div>Building exam-level Q&amp;A pairsâ€¦</div>
      <div class="ldstep" id="ls3"><div class="ldstep-dot"></div>Mapping to NCERT chapters &amp; prioritiesâ€¦</div>
    </div>
  </div>
</div>

<!-- â•â• CARD VIEWER â•â• -->
<div id="screen-cards" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen</div>
    <div class="nav-actions">
      <button class="nb sb-toggle" id="sb-toggle">ğŸ· Topics</button>
      <button class="nb" id="cv-back">â† Library</button>
      <button class="nb" id="cv-quiz">ğŸ¯ Quiz</button>
      <button class="nb" id="cv-exam-sim">ğŸ“ Exam Sim</button>
      <button class="nb" id="cv-predict">ğŸ”® Predict</button>
      <button class="nb" id="cv-mindmap">ğŸ—º Mind Map</button>
      <button class="nb" id="cv-notes">ğŸ“ Notes</button>
      <button class="nb" id="cv-summary">ğŸ“‹ Summary</button>
      <button class="nb" id="cv-dash">ğŸ“Š Stats</button>
      <button class="nb primary" id="cv-new">+ New</button>
    </div>
  </nav>
  <div class="exam-banner" id="exam-banner"></div>
  <div class="cv-layout">
    <div class="sidebar" id="sidebar">
      <div class="sbhd">Document</div>
      <div class="sb-info" id="sb-name">â€”</div>
      <div class="sb-meta-t" id="sb-meta">â€”</div>
      <div id="sb-chapters"></div>
      <div id="sb-topics"></div>
      <!-- Weak Topics section in sidebar -->
      <div class="sbhd" id="weak-topics-hdr" style="display:none;margin-top:.5rem">âš  Weak Topics</div>
      <div id="sb-weak-topics"></div>
    </div>
    <div class="card-area">
      <div class="doc-banner fin">
        <div class="di">ğŸ“‘</div>
        <div style="flex:1"><div class="dn" id="doc-name">â€”</div><div class="dm" id="doc-meta">â€”</div></div>
        <div class="etag" id="etag" style="display:none"></div>
      </div>
      <div class="prog-wrap fin" style="animation-delay:.05s">
        <div class="prog-info"><span id="card-ctr">1 / 10</span><span id="pct-seen">0% seen</span></div>
        <div class="prog-track"><div class="prog-fill" id="prog-fill" style="width:0%"></div></div>
      </div>
      <div class="card-scene" id="card-scene">
        <div class="card-inner">
          <div class="card-face card-front">
            <div class="priodot" id="prio-dot"></div>
            <div class="tbadge" id="tbadge-f"></div>
            <div class="cchip" id="chip-f">Topic</div>
            <div class="card-q" id="card-q">â€”</div>
            <div class="flip-hint">tap to reveal â†©</div>
          </div>
          <div class="card-face card-back">
            <div class="tbadge" id="tbadge-b"></div>
            <div class="cchip" id="chip-b">Answer</div>
            <div class="card-a" id="card-a">â€”</div>
            <div class="flip-hint">tap to flip back â†©</div>
          </div>
        </div>
      </div>
      <!-- SM-2 Rating -->
      <div class="sr-row fin" id="sr-row" style="display:none;animation-delay:.08s">
        <button class="sr-btn sr-again" id="sr-again">â†© Again<br><small>forgot</small></button>
        <button class="sr-btn sr-hard" id="sr-hard">ğŸ˜“ Hard<br><small>+1 day</small></button>
        <button class="sr-btn sr-good" id="sr-good">ğŸ‘ Good<br><small>tomorrow</small></button>
        <button class="sr-btn sr-easy" id="sr-easy">âš¡ Easy<br><small>next week</small></button>
      </div>
      <div class="sr-hint" id="sr-hint" style="display:none">Rate to schedule with Spaced Repetition Â· <kbd>1</kbd> Again Â· <kbd>2</kbd> Hard Â· <kbd>3</kbd> Good Â· <kbd>4</kbd> Easy</div>
      <div class="card-ctrls fin" style="animation-delay:.12s">
        <button class="ctrl ctrl-nav" id="prev-btn" disabled>â† Prev</button>
        <button class="ctrl ctrl-flip" id="flip-btn">Flip Card</button>
        <button class="ctrl ctrl-nav" id="next-btn">Next â†’</button>
        <button class="ctrl ctrl-act" id="explain-btn">ğŸ’¡ Explain</button>
        <button class="ctrl ctrl-act" id="voice-btn">ğŸ”Š Read</button>
        <button class="ctrl ctrl-act" id="shuffle-btn">ğŸ”€</button>
        <button class="ctrl ctrl-act" id="doubt-btn">ğŸ¤– Ask AI</button>
      </div>
      <div class="swipe-indicator">ğŸ‘† Swipe card left/right to navigate</div>
      <div class="kb-row">
        <span><kbd>â†</kbd> prev</span><span><kbd>Space</kbd> flip</span><span><kbd>â†’</kbd> next</span>
        <span><kbd>1-4</kbd> rate</span><span><kbd>E</kbd> explain</span><span><kbd>V</kbd> voice</span>
      </div>
    </div>
  </div>
</div>

<!-- â•â• EXPLAIN MODAL â•â• -->
<div class="modal-overlay" id="explain-overlay">
  <div class="explain-modal">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ’¡ Deep Explanation</div>
      <button class="explain-close" id="explain-close">âœ• Close</button>
    </div>
    <div id="explain-body"></div>
  </div>
</div>

<!-- â•â• AI DOUBT CHAT MODAL â•â• -->
<div class="modal-overlay" id="doubt-overlay">
  <div class="doubt-modal">
    <div class="doubt-hdr">
      <div class="doubt-title">ğŸ¤– AI Doubt Assistant</div>
      <button class="explain-close" id="doubt-close">âœ• Close</button>
    </div>
    <div class="doubt-context" id="doubt-context"></div>
    <div class="doubt-messages" id="doubt-messages"></div>
    <div class="doubt-input-row">
      <input class="doubt-input" type="text" id="doubt-input" placeholder="Ask anything about this topicâ€¦" autocomplete="off"/>
      <button class="doubt-send" id="doubt-send">Send â†’</button>
    </div>
  </div>
</div>

<!-- â•â• NOTES MODAL (Weak Topic Notes) â•â• -->
<div class="modal-overlay" id="notes-overlay">
  <div class="notes-modal">
    <div class="notes-hdr">
      <div class="notes-title">ğŸ“ My Topic Notes</div>
      <button class="explain-close" id="notes-close">âœ• Close</button>
    </div>
    <div class="notes-tabs" id="notes-topic-tabs"></div>
    <div class="notes-body">
      <div class="notes-meta">Write notes on weak topics. Explain concepts in your own words â€” it's proven to boost retention!</div>
      <select class="sel" id="notes-topic-sel" style="margin-bottom:.75rem"></select>
      <textarea class="notes-area" id="notes-textarea" placeholder="Write your understanding of this topic hereâ€¦&#10;&#10;â€¢ What is the core concept?&#10;â€¢ Why does it work this way?&#10;â€¢ Common mistakes to avoidâ€¦"></textarea>
      <div class="notes-actions">
        <button class="nb primary" id="notes-save">ğŸ’¾ Save Note</button>
        <button class="nb" id="notes-ask-ai">ğŸ¤– Ask AI About This</button>
        <button class="nb" id="notes-clear">ğŸ—‘ Clear</button>
      </div>
      <div class="saved-notes" id="saved-notes-list"></div>
    </div>
  </div>
</div>

<!-- â•â• SUMMARY MODAL â•â• -->
<div class="modal-overlay" id="summary-overlay">
  <div class="explain-modal">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ“‹ AI Topic Summary</div>
      <button class="explain-close" id="summary-close">âœ• Close</button>
    </div>
    <div id="summary-body"></div>
  </div>
</div>

<!-- â•â• FOCUS TIMER MODAL â•â• -->
<div class="modal-overlay" id="timer-overlay">
  <div class="timer-modal">
    <div class="timer-hdr">
      <div class="timer-title">â± Focus Timer</div>
      <button class="explain-close" id="timer-close">âœ• Close</button>
    </div>
    <div class="timer-display" id="timer-display">25:00</div>
    <div class="timer-label" id="timer-label">Study Session</div>
    <div class="timer-ring-wrap">
      <svg class="timer-ring" viewBox="0 0 120 120">
        <circle class="timer-ring-bg" cx="60" cy="60" r="52"/>
        <circle class="timer-ring-prog" id="timer-ring-prog" cx="60" cy="60" r="52"/>
      </svg>
    </div>
    <div class="timer-presets">
      <button class="nb timer-preset active" data-mins="25">25m Pomodoro</button>
      <button class="nb timer-preset" data-mins="45">45m Deep</button>
      <button class="nb timer-preset" data-mins="5">5m Break</button>
      <button class="nb timer-preset" data-mins="15">15m Break</button>
    </div>
    <div class="timer-ctrls">
      <button class="btn-full" id="timer-start">â–¶ Start</button>
      <button class="nb" id="timer-reset">â†º Reset</button>
    </div>
    <div class="timer-sessions">Sessions today: <strong id="timer-sessions-count">0</strong> Â· Total: <strong id="timer-total-mins">0</strong>m</div>
  </div>
</div>

<!-- â•â• DASHBOARD â•â• -->
<div id="screen-dashboard" class="screen">
  <nav class="nav">
    <div class="nav-brand">FlashGen</div>
    <div class="nav-actions"><button class="nb" id="dash-back">â† Back</button></div>
  </nav>
  <div class="dash-wrap">
    <div class="dash-ttl">Your <span>Progress</span></div>
    <div class="dash-grid">
      <div class="dc">
        <h3>ğŸ“ˆ Overview</h3>
        <div class="stat-row">
          <div class="sbox"><div class="snum" id="s-decks">0</div><div class="slbl">Decks</div></div>
          <div class="sbox"><div class="snum" id="s-rated">0</div><div class="slbl">Rated</div></div>
          <div class="sbox"><div class="snum" id="s-pct">â€”</div><div class="slbl">Known %</div></div>
          <div class="sbox"><div class="snum" id="s-due">0</div><div class="slbl">Due Today</div></div>
        </div>
      </div>
      <div class="dc">
        <h3>ğŸ”¥ Study Streak</h3>
        <div class="streak-disp">
          <div class="sf">ğŸ”¥</div>
          <div><div class="sn" id="d-streak">0</div><div class="ss" id="d-sub">days in a row</div><div class="ss" style="margin-top:.2rem">Best: <strong id="d-best">0</strong> days</div></div>
        </div>
        <div class="scal" id="d-cal"></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ† Badges</h3>
        <div class="badges-g" id="badges-g"></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ¯ Weak Spots <small style="font-size:.7rem;color:var(--ink-2);font-weight:300;font-family:'DM Mono',monospace"> â€” topics needing attention</small></h3>
        <div class="weak-list" id="weak-list"><div style="color:var(--ink-2);font-size:.85rem">Rate cards to identify weak spots!</div></div>
      </div>
      <div class="dc" style="grid-column:1/-1">
        <h3>ğŸ“Š Topic Mastery</h3>
        <div id="no-mastery" style="color:var(--ink-2);font-size:.85rem;text-align:center;padding:2rem">Flip cards and rate them to see mastery here!</div>
        <div class="chart-wrap" id="chart-wrap" style="display:none"><canvas id="mastery-chart"></canvas></div>
        <table class="mtable" id="mtable" style="display:none">
          <thead><tr><th>Topic</th><th>Chapter</th><th>âœ“ Known</th><th>âœ— Review</th><th>Mastery</th><th>SR Due</th></tr></thead>
          <tbody id="mtbody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>
<div class="coins-popup" id="coins-popup">ğŸª™ +<span id="coins-amount">0</span></div>

<!-- â•â• AI EXAM PREDICTOR MODAL â•â• -->
<div class="modal-overlay" id="predict-overlay">
  <div class="explain-modal" style="max-width:600px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ”® AI Exam Predictor</div>
      <button class="explain-close" id="predict-close">âœ• Close</button>
    </div>
    <div id="predict-body"></div>
  </div>
</div>

<!-- â•â• ADAPTIVE REWORD MODAL â•â• -->
<div class="modal-overlay" id="adaptive-overlay">
  <div class="explain-modal" style="max-width:540px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ”„ Simplified Card</div>
      <button class="explain-close" id="adaptive-close">âœ• Close</button>
    </div>
    <div id="adaptive-body"></div>
    <div style="padding:0 1.5rem 1.5rem;display:flex;gap:.75rem">
      <button class="btn-full" id="adaptive-replace" style="display:none">Replace Original Card</button>
    </div>
  </div>
</div>

<!-- â•â• MIND MAP MODAL â•â• -->
<div class="modal-overlay" id="mindmap-overlay">
  <div class="explain-modal" style="max-width:700px;max-height:90vh">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ—º Concept Mind Map</div>
      <button class="explain-close" id="mindmap-close">âœ• Close</button>
    </div>
    <div id="mindmap-body" style="overflow:auto;padding:1rem 1.5rem 1.5rem"></div>
  </div>
</div>

<!-- â•â• STUDY ROOM MODAL â•â• -->
<div class="modal-overlay" id="room-overlay">
  <div class="explain-modal" style="max-width:560px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ‘¥ Study Room</div>
      <button class="explain-close" id="room-close">âœ• Close</button>
    </div>
    <div id="room-body">
      <div style="padding:1.5rem">
        <div class="room-section">
          <div class="explain-title" style="font-size:.9rem;margin-bottom:.75rem">Create a Room</div>
          <p style="font-size:.8rem;color:var(--ink-2);margin-bottom:.75rem">Share your room code with friends studying the same deck. Everyone sees each other's progress live.</p>
          <button class="btn-full" id="room-create-btn">ğŸš€ Create New Room</button>
        </div>
        <div class="room-divider">or</div>
        <div class="room-section">
          <div class="explain-title" style="font-size:.9rem;margin-bottom:.75rem">Join a Room</div>
          <input class="inp" type="text" id="room-code-input" placeholder="Enter 6-digit room code" maxlength="6" style="text-transform:uppercase;letter-spacing:.2em;font-family:'DM Mono',monospace;font-size:1.2rem;text-align:center"/>
          <button class="btn-full" id="room-join-btn" style="margin-top:.75rem">Join Room â†’</button>
        </div>
        <div id="room-active" style="display:none">
          <div class="room-code-display">
            <div style="font-size:.7rem;color:var(--ink-2);margin-bottom:.3rem;font-family:'DM Mono',monospace">ROOM CODE</div>
            <div id="room-code-show" style="font-size:2rem;font-weight:700;letter-spacing:.25em;color:var(--ac);font-family:'DM Mono',monospace"></div>
            <button class="nb" id="room-copy-code" style="margin-top:.5rem;font-size:.7rem">ğŸ“‹ Copy Code</button>
          </div>
          <div class="room-members" id="room-members"></div>
          <div class="room-feed" id="room-feed"></div>
          <button class="nb" id="room-leave-btn" style="margin-top:1rem;width:100%;color:#ef4444;border-color:#ef4444">Leave Room</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• REWARD SHOP MODAL â•â• -->
<div class="modal-overlay" id="shop-overlay">
  <div class="explain-modal" style="max-width:560px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ› Reward Shop</div>
      <button class="explain-close" id="shop-close">âœ• Close</button>
    </div>
    <div id="shop-body">
      <div style="padding:1.5rem">
        <div class="shop-balance">
          <span class="shop-coins-icon">ğŸª™</span>
          <span id="shop-coins-display">0</span>
          <span style="font-size:.8rem;color:var(--ink-2);margin-left:.4rem">coins</span>
          <span style="font-size:.7rem;color:var(--ink-3);margin-left:.75rem;font-family:'DM Mono',monospace">Rate cards & quiz to earn</span>
        </div>
        <div class="shop-grid" id="shop-grid"></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• EXAM SIMULATION MODAL â•â• -->
<div class="modal-overlay" id="examsim-overlay">
  <div class="explain-modal" style="max-width:680px;max-height:95vh">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ“ Exam Simulation</div>
      <button class="explain-close" id="examsim-close">âœ• Close</button>
    </div>
    <div id="examsim-body">
      <!-- Setup screen -->
      <div id="examsim-setup" style="padding:1.5rem">
        <p style="font-size:.85rem;color:var(--ink-2);margin-bottom:1.25rem">Simulates a real exam environment â€” timed, negative marking, section-wise. No hints, no explanations until the end.</p>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1.25rem">
          <div>
            <span class="lbl">Exam Pattern</span>
            <select class="sel" id="sim-pattern">
              <option value="jee">JEE Main (90 min, â€“Â¼ marking)</option>
              <option value="neet">NEET (180 min, â€“1 marking)</option>
              <option value="cbse">CBSE Board (180 min, no negative)</option>
              <option value="upsc">UPSC (120 min, â€“â…“ marking)</option>
              <option value="custom">Custom</option>
            </select>
          </div>
          <div>
            <span class="lbl">Questions</span>
            <select class="sel" id="sim-qcount">
              <option value="10">10 questions</option>
              <option value="20" selected>20 questions</option>
              <option value="30">30 questions</option>
              <option value="50">50 questions</option>
            </select>
          </div>
          <div>
            <span class="lbl">Time Limit (minutes)</span>
            <input class="inp" type="number" id="sim-time" value="30" min="5" max="180"/>
          </div>
          <div>
            <span class="lbl">Marks per correct</span>
            <input class="inp" type="number" id="sim-marks" value="4" min="1" max="10"/>
          </div>
          <div>
            <span class="lbl">Negative marking</span>
            <input class="inp" type="number" id="sim-negative" value="-1" max="0" min="-5" step="0.25"/>
          </div>
        </div>
        <button class="btn-full" id="examsim-start-btn">ğŸš€ Start Exam Simulation</button>
      </div>
      <!-- Active exam -->
      <div id="examsim-active" style="display:none;padding:1.25rem">
        <div class="sim-hud">
          <div class="sim-hud-item"><span id="sim-q-num">Q1/20</span></div>
          <div class="sim-hud-item sim-timer-display" id="sim-timer-display">30:00</div>
          <div class="sim-hud-item">Score: <strong id="sim-score-live">0</strong></div>
          <div class="sim-hud-item" style="color:#f59e0b">Attempted: <strong id="sim-attempted">0</strong></div>
        </div>
        <div class="sim-progress-bar"><div id="sim-prog-fill" style="width:0%"></div></div>
        <div class="sim-question" id="sim-question"></div>
        <div class="sim-options" id="sim-options"></div>
        <div class="sim-nav">
          <button class="nb" id="sim-prev-btn">â† Prev</button>
          <button class="nb" id="sim-skip-btn" style="color:#f59e0b;border-color:#f59e0b">Skip â†’</button>
          <button class="nb" id="sim-next-btn">Next â†’</button>
          <button class="nb" id="sim-review-btn" style="color:#a78bfa;border-color:#a78bfa">ğŸ“Œ Review Later</button>
          <button class="nb" id="sim-submit-btn" style="color:#ef4444;border-color:#ef4444;margin-left:auto">Submit Exam</button>
        </div>
        <div class="sim-palette" id="sim-palette"></div>
      </div>
      <!-- Results -->
      <div id="examsim-results" style="display:none;padding:1.25rem"></div>
    </div>
  </div>
</div>

<!-- â•â• WRONG ANSWER EXPLAINER (from quiz) â•â• -->
<div class="modal-overlay" id="wrongexp-overlay">
  <div class="explain-modal" style="max-width:540px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ’¡ Why Was I Wrong?</div>
      <button class="explain-close" id="wrongexp-close">âœ• Close</button>
    </div>
    <div id="wrongexp-body"></div>
  </div>
</div>

<!-- â•â• WHATSAPP/TELEGRAM BOT MODAL â•â• -->
<div class="modal-overlay" id="bot-overlay">
  <div class="explain-modal" style="max-width:520px">
    <div class="explain-hdr">
      <div class="explain-title">ğŸ“± Daily Card Bot</div>
      <button class="explain-close" id="bot-close">âœ• Close</button>
    </div>
    <div id="bot-body" style="padding:1.5rem">
      <p style="font-size:.85rem;color:var(--ink-2);margin-bottom:1.25rem;line-height:1.7">Get 5 flashcard questions delivered to you every morning on WhatsApp or Telegram. Answer in the chat â€” great for studying on the go!</p>
      <div class="bot-options">
        <div class="bot-card" id="bot-whatsapp">
          <div class="bot-icon">ğŸ’¬</div>
          <div class="bot-name">WhatsApp</div>
          <div class="bot-desc">Share today's 5 cards to WhatsApp</div>
          <button class="btn-full" id="bot-wa-btn" style="margin-top:.75rem">Open in WhatsApp â†’</button>
        </div>
        <div class="bot-card" id="bot-telegram">
          <div class="bot-icon">âœˆï¸</div>
          <div class="bot-name">Telegram</div>
          <div class="bot-desc">Share today's 5 cards to Telegram</div>
          <button class="btn-full" id="bot-tg-btn" style="margin-top:.75rem">Open in Telegram â†’</button>
        </div>
      </div>
      <div class="bot-preview" id="bot-preview" style="margin-top:1.25rem">
        <div style="font-size:.75rem;color:var(--ink-2);font-family:'DM Mono',monospace;margin-bottom:.5rem">PREVIEW (today's 5 cards)</div>
        <div id="bot-cards-preview" style="font-size:.8rem;color:var(--ink);line-height:1.8;white-space:pre-wrap;font-family:'DM Mono',monospace;background:var(--surf);border:1px solid var(--br);border-radius:12px;padding:.85rem 1rem;max-height:200px;overflow-y:auto"></div>
      </div>
      <div style="margin-top:1rem;padding:.75rem;background:var(--surf);border-radius:10px;border:1px solid var(--br)">
        <div style="font-size:.72rem;color:var(--ink-2);line-height:1.7">ğŸ“… <strong>Set a daily reminder:</strong> Schedule a recurring alarm at your preferred time and tap this button each morning to send that day's cards.</div>
        <button class="nb" id="bot-alarm-btn" style="margin-top:.6rem;width:100%">â° Set Morning Reminder</button>
      </div>
    </div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
